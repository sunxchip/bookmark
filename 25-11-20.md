#  📄 README-2025-11-20

## 개요

- 오늘 작업: SQLite 영속화 기반 구축 + 진행률 계산 통일 + 동기화 이벤트 스트림 토대

- 대상 앱: bookmark (독서 기록/진행률 추적)
---

## 오늘 반영 사항

- DB 도입: sqflite, path_provider

- 스키마 v2 (메모 필드 포함)

- libraryItems() DTO (내서재 카드에 진행률 표시용)

- changes Stream으로 화면 동기화 이벤트 브로드캐스트

---

## 다음 스프린트

- 타이머 저장 후 0초로 리셋(진행률은 누적 반영)

- 읽은 페이지 입력 팝업 중복 노출 방지(한 번만)

- 이어읽기 화면 NotoSans 전역 적용(제목/본문/Chip)

- 내서재와 이어읽기 동기화

- 라이브러리에서 책 선택 시 이어읽기 즉시 전환

- SqliteRepository.changes 구독으로 진행률/총페이지 실시간 반영

- 기록(세션) 책별 분리 보관/표시

- 기록 칩 탭 → 메모 보기/삭제/뒤로가기 바텀시트

- 내서재에서 다른 책 누를 때 이어읽기 화면 내용 변경

---

## 수용 기준

- 저장 후 타이머 00:00:00으로 리셋, 진행률 바는 입력 페이지 반영으로 정상 증가

- 페이지 팝업 단일 노출

- 라이브러리에서 책 전환 시 이어읽기 즉시 전환

- 기록 칩 탭 → 메모/삭제/뒤로가기 바텀시트 정상 동작, 삭제 시 즉시 목록 갱신

- 앱 재시작 후 데이터/진행률/기록 영속 유지


---

## 작업 계획(파일 단위)

1. 타이머 리셋 & 진행률 누적

  - pages/reading/widgets/reading_timer_card.dart

- 저장 성공 콜백에서 시간만 reset() 처리, 진행률 업데이트는 Repo 반영 → changes 스트림으로 UI 갱신

2. 페이지 팝업 단일화

- reading_timer_card.dart, reading_log_sheet.dart

- _showingLog 플래그로 중복 호출 방지

nav/app_theme.dart에서 fontFamily: 'NotoSans' 지정, weight 매핑

3. 내서재 ↔ 이어읽기 동기화

- 라이브러리 선택 이벤트 → 현재 세션 교체

- SqliteRepository.changes.listen 구독

4. 기록 칩 바텀시트(메모/삭제/뒤로)

- reading_detail_view.dart(칩 onTap)

- Repo: deleteSession(id) 호출, 목록/진행률 재로드

5. 내서재 카드 진행률 표시

- libraryItems() 사용, currentPage/totalPages 표시 통일
